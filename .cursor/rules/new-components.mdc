---
description: Creating New Components
patterns:
  - "**create** a new **component**"
  - "**generate** a new **component**"
  - "**build** a new **component**"
  - "**make** a new **component**"
---

This rule automates the creation of reusable HTML/CSS components, demos, and (if applicable) a subclass of `RapidUI::ApplicationComponent` and Rails helpers to aide in reuse.

When asked to generate a new component:

1. **Decide component category** (see component namespaces in `test/dummy/config/routes.rb`)

2. **Create new category infrastructure** (if needed)
   - Add route: `get :{category}, to: "categories#{category}"` and `namespace :{category}`
   - Create `app/helpers/rapid_ui/{:category}_helper.rb` and include in `application_helper.rb`
   - Create controller `test/dummy/app/controllers/components/{:category}_controller.rb` with `helper RapidUI::{Category}Helper`
   - Create category index view `test/dummy/app/views/components/categories/{:category}.html.erb`
   - Add action to Categories controller

3. **Generate CSS**
   - Create `app/assets/stylesheets/rapid_ui/{:category}/{:component_plural}.css`
   - Import it in `app/assets/stylesheets/rapid_ui/{:category}/index.css`

4. **Generate initial HTML/CSS demo**
   - Add route in `test/dummy/config/routes.rb` under the appropriate namespace
   - Create ERB file `test/dummy/app/views/components/{:category}/{:component_plural}.html.erb`
   - Set page title: `<% layout.head.title = ["{Component}", "{Category}", "Components"] %>`
   - Each feature demo in its own `<div class="demo-section">`
   - Use plain HTML/CSS (no helpers yet)
   - Update sidebar in `test/dummy/app/controllers/components/base_controller.rb` to link to this new demo (and remove its TODO if necessary)
   - Add the demo page to `test/components/{:category}_test.rb`

5. **Ask user to review/approve HTML/CSS** before proceeding

6. **Create component class** (if complexity-saving)
   - Implement subclass of `RapidUI::ApplicationComponent` in `app/view_components/rapid_ui/`
   - Add render function (`#call` or ERB template)

7. **Implement ERB helpers**
   - Create `app/helpers/rapid_ui/{:category}/{:component_plural}_helper.rb`
   - Add `new_{:component_name}` builder methods
   - Add rendered helper methods (e.g., `def alert(*args, **kwargs, &block)`)
   - Create or update `app/helpers/rapid_ui/{:category}_helper.rb` to include this module
   - Ensure `app/helpers/rapid_ui/application_helper.rb` includes the category helper

8. **Rework demos to use ERB helpers**
   - Update `demo_code` calls with `helper: :method_name` and optional `content_class:`
   - **ERB code ALWAYS uses `with_*` methods** (e.g., `<%= f.with_text_field_group ... %>`)
   - **Ruby code ALWAYS uses `build_*` methods** (e.g., `f.build_text_field_group(...)`)
   - This applies to ALL builder methods, including nested components and field groups
   - Method names follow pattern: `component_{:category}_{:component}_{:feature}`
   - Example: `helper: :component_feedback_alert_variants`

9. **Generate pure Ruby helper methods**
   - Create in `test/dummy/app/helpers/components/{:category}/{:component_plural}_helper.rb`
   - Module namespace: `Components::{Category}::{ComponentPlural}Helper`
   - One method per demo section matching the ERB helper names
   - Use `demo_components` helper like `demo_components do |c|` and build components with `c << new_alert(...)`
   - **CRITICAL**: When building nested components (e.g., fields in a form), ALWAYS use `build_*` methods
   - Example: `f.build_text_field_group(...)` NOT `f.with_text_field_group(...)`
   - The `with_*` methods are ONLY for ERB templates, NEVER for Ruby code

10. **Ask user to review/approve ERB design**
